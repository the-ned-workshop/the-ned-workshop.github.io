---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getEvents, formatEventDate } from '../lib/events';

const events = await getEvents();
const now = new Date();
const upcomingEvents = events.filter(e => e.date >= now);
---

<BaseLayout title="Home">
  <div class="max-w-5xl mx-auto px-6 py-16">
    <!-- Hero Section -->
    <div class="text-center mb-20">
      <h1 class="text-5xl md:text-7xl font-extrabold leading-tight text-amber-600">
        Welcome to The Ned Workshop!
      </h1>
    </div>

    <!-- Upcoming Events Card -->
    <div class="card p-10 mb-10">
      <h2 class="text-3xl md:text-4xl font-extrabold mb-2 text-amber-600">
        Upcoming Events
      </h2>
      <p class="text-stone-500 font-medium mb-6">
        More to come as we build out the class content and find a venue(s).
      </p>
      <div class="space-y-6">
        {upcomingEvents.length > 0 ? (
          upcomingEvents.map((event) => (
            <div class="bg-amber-50 rounded-2xl p-6 border border-amber-200">
              <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4 mb-4">
                <h3 class="text-2xl font-bold text-amber-700">{event.title}</h3>
                <div class="md:text-right">
                  <p class="text-lg font-bold text-amber-600">{formatEventDate(event.date)}</p>
                  <p class="text-stone-600 font-medium">{event.startTime} - {event.endTime}</p>
                </div>
              </div>
              <div class="space-y-3 text-stone-600 font-medium">
                {event.description.split('\n\n').map((paragraph) => (
                  <p>{paragraph}</p>
                ))}
                <div class="pt-3 border-t border-amber-200">
                  <p>
                    <span class="font-bold text-amber-700">Location:</span>{' '}
                    {event.locationUrl ? (
                      <a href={event.locationUrl} target="_blank" rel="noopener noreferrer" class="text-amber-600 hover:text-amber-700 underline decoration-amber-300 decoration-2 underline-offset-4 hover:decoration-amber-400 transition-colors duration-300">
                        {event.location}
                      </a>
                    ) : (
                      event.location
                    )}
                  </p>
                  <p>
                    <span class="font-bold text-amber-700">Cost:</span> {event.cost}
                    {event.costNote && ` - ${event.costNote}`}
                  </p>
                </div>
              </div>
            </div>
          ))
        ) : (
          <div>
            <p class="text-lg text-stone-500 italic font-medium">
              No upcoming events scheduled.
            </p>
            <p class="text-lg text-stone-600 font-medium mt-4">
              Check back here for updates on classes, open workshop hours, and community events.
            </p>
          </div>
        )}
      </div>
    </div>

    <!-- Contact Card -->
    <div class="card p-10">
      <h2 class="text-3xl md:text-4xl font-extrabold mb-6 text-amber-600">
        Say Hello!
      </h2>
      <p class="text-xl text-stone-600 font-medium">
        Reach out at
        <a href="mailto:info@nedworkshop.org" class="font-bold text-amber-600 hover:text-amber-700 underline decoration-amber-300 decoration-2 underline-offset-4 hover:decoration-amber-400 transition-colors duration-300">
          info@nedworkshop.org
        </a>
      </p>
    </div>
  </div>
</BaseLayout>
